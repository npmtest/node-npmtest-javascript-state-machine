<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-javascript-state-machine/node_modules/javascript-state-machine/state-machine.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-javascript-state-machine">npmtest-javascript-state-machine (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-javascript-state-machine/node_modules/javascript-state-machine/state-machine.js</span></h1>
    <h2>
        
        Statements: <span class="metric">5.26% <small>(6 / 114)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">3.77% <small>(4 / 106)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">3.45% <small>(1 / 29)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">5.66% <small>(6 / 106)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-javascript-state-machine/node_modules/javascript-state-machine/</a> &#187; state-machine.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/*
&nbsp;
  Javascript State Machine Library - https://github.com/jakesgordon/javascript-state-machine
&nbsp;
  Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors
  Released under the MIT license - https://github.com/jakesgordon/javascript-state-machine/blob/master/LICENSE
&nbsp;
*/
&nbsp;
(function () {
&nbsp;
  var StateMachine = {
&nbsp;
    //---------------------------------------------------------------------------
&nbsp;
    VERSION: "2.4.0",
&nbsp;
    //---------------------------------------------------------------------------
&nbsp;
    Result: {
      SUCCEEDED:    1, // the event transitioned successfully from one state to another
      NOTRANSITION: 2, // the event was successfull but no state transition was necessary
      CANCELLED:    3, // the event was cancelled by the caller in a beforeEvent callback
      PENDING:      4  // the event is asynchronous and the caller is in control of when the transition occurs
    },
&nbsp;
    Error: {
      INVALID_TRANSITION: 100, // caller tried to fire an event that was innapropriate in the current state
      PENDING_TRANSITION: 200, // caller tried to fire an event while an async transition was still pending
      INVALID_CALLBACK:   300 // caller provided callback function threw an exception
    },
&nbsp;
    WILDCARD: '*',
    ASYNC: 'async',
&nbsp;
    //---------------------------------------------------------------------------
&nbsp;
    create: <span class="fstat-no" title="function not covered" >function(cfg, target) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      var initial      = (typeof cfg.initial == 'string') ? { state: cfg.initial } : cfg.initial; </span>// allow for a simple string, or an object with { state: 'foo', event: 'setup', defer: true|false }
<span class="cstat-no" title="statement not covered" >      var terminal     = cfg.terminal || cfg['final'];</span>
<span class="cstat-no" title="statement not covered" >      var fsm          = target || cfg.target  || {};</span>
<span class="cstat-no" title="statement not covered" >      var events       = cfg.events || [];</span>
<span class="cstat-no" title="statement not covered" >      var callbacks    = cfg.callbacks || {};</span>
<span class="cstat-no" title="statement not covered" >      var map          = {}; </span>// track state transitions allowed for an event { event: { from: [ to ] } }
<span class="cstat-no" title="statement not covered" >      var transitions  = {}; </span>// track events allowed from a state            { state: [ event ] }
&nbsp;
<span class="cstat-no" title="statement not covered" >      var add = <span class="fstat-no" title="function not covered" >function(e) {</span></span>
<span class="cstat-no" title="statement not covered" >        var from = Array.isArray(e.from) ? e.from : (e.from ? [e.from] : [StateMachine.WILDCARD]); </span>// allow 'wildcard' transition if 'from' is not specified
<span class="cstat-no" title="statement not covered" >        map[e.name] = map[e.name] || {};</span>
<span class="cstat-no" title="statement not covered" >        for (var n = 0 ; n &lt; from.length ; n++) {</span>
<span class="cstat-no" title="statement not covered" >          transitions[from[n]] = transitions[from[n]] || [];</span>
<span class="cstat-no" title="statement not covered" >          transitions[from[n]].push(e.name);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >          map[e.name][from[n]] = e.to || from[n]; </span>// allow no-op transition if 'to' is not specified
        }
<span class="cstat-no" title="statement not covered" >        if (e.to)</span>
<span class="cstat-no" title="statement not covered" >          transitions[e.to] = transitions[e.to] || [];</span>
      };
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (initial) {</span>
<span class="cstat-no" title="statement not covered" >        initial.event = initial.event || 'startup';</span>
<span class="cstat-no" title="statement not covered" >        add({ name: initial.event, from: 'none', to: initial.state });</span>
      }
&nbsp;
<span class="cstat-no" title="statement not covered" >      for(var n = 0 ; n &lt; events.length ; n++)</span>
<span class="cstat-no" title="statement not covered" >        add(events[n]);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      for(var name in map) {</span>
<span class="cstat-no" title="statement not covered" >        if (map.hasOwnProperty(name))</span>
<span class="cstat-no" title="statement not covered" >          fsm[name] = StateMachine.buildEvent(name, map[name]);</span>
      }
&nbsp;
<span class="cstat-no" title="statement not covered" >      for(var name in callbacks) {</span>
<span class="cstat-no" title="statement not covered" >        if (callbacks.hasOwnProperty(name))</span>
<span class="cstat-no" title="statement not covered" >          fsm[name] = callbacks[name]</span>
      }
&nbsp;
<span class="cstat-no" title="statement not covered" >      fsm.current     = 'none';</span>
<span class="cstat-no" title="statement not covered" >      fsm.is          = <span class="fstat-no" title="function not covered" >function(state) {</span> <span class="cstat-no" title="statement not covered" >return Array.isArray(state) ? (state.indexOf(this.current) &gt;= 0) : (this.current === state); </span>};</span>
<span class="cstat-no" title="statement not covered" >      fsm.can         = <span class="fstat-no" title="function not covered" >function(event) {</span> <span class="cstat-no" title="statement not covered" >return !this.transition &amp;&amp; (map[event] !== undefined) &amp;&amp; (map[event].hasOwnProperty(this.current) || map[event].hasOwnProperty(StateMachine.WILDCARD)); </span>}</span>
<span class="cstat-no" title="statement not covered" >      fsm.cannot      = <span class="fstat-no" title="function not covered" >function(event) {</span> <span class="cstat-no" title="statement not covered" >return !this.can(event); </span>};</span>
<span class="cstat-no" title="statement not covered" >      fsm.transitions = <span class="fstat-no" title="function not covered" >function()      {</span> <span class="cstat-no" title="statement not covered" >return (transitions[this.current] || []).concat(transitions[StateMachine.WILDCARD] || []); </span>};</span>
<span class="cstat-no" title="statement not covered" >      fsm.isFinished  = <span class="fstat-no" title="function not covered" >function()      {</span> <span class="cstat-no" title="statement not covered" >return this.is(terminal); </span>};</span>
<span class="cstat-no" title="statement not covered" >      fsm.error       = cfg.error || <span class="fstat-no" title="function not covered" >function(name, from, to, args, error, msg, e) {</span> <span class="cstat-no" title="statement not covered" >throw e || msg; </span>}; </span>// default behavior when something unexpected happens is to throw an exception, but caller can override this behavior if desired (see github issue #3 and #17)
<span class="cstat-no" title="statement not covered" >      fsm.states      = <span class="fstat-no" title="function not covered" >function() {</span> <span class="cstat-no" title="statement not covered" >return Object.keys(transitions).sort() }</span>;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (initial &amp;&amp; !initial.defer)</span>
<span class="cstat-no" title="statement not covered" >        fsm[initial.event]();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      return fsm;</span>
&nbsp;
    },
&nbsp;
    //===========================================================================
&nbsp;
    doCallback: <span class="fstat-no" title="function not covered" >function(fsm, func, name, from, to, args) {</span>
<span class="cstat-no" title="statement not covered" >      if (func) {</span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >          return func.apply(fsm, [name, from, to].concat(args));</span>
        }
        catch(e) {
<span class="cstat-no" title="statement not covered" >          return fsm.error(name, from, to, args, StateMachine.Error.INVALID_CALLBACK, "an exception occurred in a caller-provided callback function", e);</span>
        }
      }
    },
&nbsp;
    beforeAnyEvent:  <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span> <span class="cstat-no" title="statement not covered" >return StateMachine.doCallback(fsm, fsm['onbeforeevent'],                       name, from, to, args); </span>},
    afterAnyEvent:   <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span> <span class="cstat-no" title="statement not covered" >return StateMachine.doCallback(fsm, fsm['onafterevent'] || fsm['onevent'],      name, from, to, args); </span>},
    leaveAnyState:   <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span> <span class="cstat-no" title="statement not covered" >return StateMachine.doCallback(fsm, fsm['onleavestate'],                        name, from, to, args); </span>},
    enterAnyState:   <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span> <span class="cstat-no" title="statement not covered" >return StateMachine.doCallback(fsm, fsm['onenterstate'] || fsm['onstate'],      name, from, to, args); </span>},
    changeState:     <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span> <span class="cstat-no" title="statement not covered" >return StateMachine.doCallback(fsm, fsm['onchangestate'],                       name, from, to, args); </span>},
&nbsp;
    beforeThisEvent: <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span> <span class="cstat-no" title="statement not covered" >return StateMachine.doCallback(fsm, fsm['onbefore' + name],                     name, from, to, args); </span>},
    afterThisEvent:  <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span> <span class="cstat-no" title="statement not covered" >return StateMachine.doCallback(fsm, fsm['onafter'  + name] || fsm['on' + name], name, from, to, args); </span>},
    leaveThisState:  <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span> <span class="cstat-no" title="statement not covered" >return StateMachine.doCallback(fsm, fsm['onleave'  + from],                     name, from, to, args); </span>},
    enterThisState:  <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span> <span class="cstat-no" title="statement not covered" >return StateMachine.doCallback(fsm, fsm['onenter'  + to]   || fsm['on' + to],   name, from, to, args); </span>},
&nbsp;
    beforeEvent: <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span>
<span class="cstat-no" title="statement not covered" >      if ((false === StateMachine.beforeThisEvent(fsm, name, from, to, args)) ||</span>
          (false === StateMachine.beforeAnyEvent( fsm, name, from, to, args)))
<span class="cstat-no" title="statement not covered" >        return false;</span>
    },
&nbsp;
    afterEvent: <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span>
<span class="cstat-no" title="statement not covered" >      StateMachine.afterThisEvent(fsm, name, from, to, args);</span>
<span class="cstat-no" title="statement not covered" >      StateMachine.afterAnyEvent( fsm, name, from, to, args);</span>
    },
&nbsp;
    leaveState: <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span>
<span class="cstat-no" title="statement not covered" >      var specific = StateMachine.leaveThisState(fsm, name, from, to, args),</span>
          general  = StateMachine.leaveAnyState( fsm, name, from, to, args);
<span class="cstat-no" title="statement not covered" >      if ((false === specific) || (false === general))</span>
<span class="cstat-no" title="statement not covered" >        return false;</span>
      else <span class="cstat-no" title="statement not covered" >if ((StateMachine.ASYNC === specific) || (StateMachine.ASYNC === general))</span>
<span class="cstat-no" title="statement not covered" >        return StateMachine.ASYNC;</span>
    },
&nbsp;
    enterState: <span class="fstat-no" title="function not covered" >function(fsm, name, from, to, args) {</span>
<span class="cstat-no" title="statement not covered" >      StateMachine.enterThisState(fsm, name, from, to, args);</span>
<span class="cstat-no" title="statement not covered" >      StateMachine.enterAnyState( fsm, name, from, to, args);</span>
    },
&nbsp;
    //===========================================================================
&nbsp;
    buildEvent: <span class="fstat-no" title="function not covered" >function(name, map) {</span>
<span class="cstat-no" title="statement not covered" >      return <span class="fstat-no" title="function not covered" >function() {</span></span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        var from  = this.current;</span>
<span class="cstat-no" title="statement not covered" >        var to    = map[from] || (map[StateMachine.WILDCARD] != StateMachine.WILDCARD ? map[StateMachine.WILDCARD] : from) || from;</span>
<span class="cstat-no" title="statement not covered" >        var args  = Array.prototype.slice.call(arguments); </span>// turn arguments into pure array
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (this.transition)</span>
<span class="cstat-no" title="statement not covered" >          return this.error(name, from, to, args, StateMachine.Error.PENDING_TRANSITION, "event " + name + " inappropriate because previous transition did not complete");</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (this.cannot(name))</span>
<span class="cstat-no" title="statement not covered" >          return this.error(name, from, to, args, StateMachine.Error.INVALID_TRANSITION, "event " + name + " inappropriate in current state " + this.current);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (false === StateMachine.beforeEvent(this, name, from, to, args))</span>
<span class="cstat-no" title="statement not covered" >          return StateMachine.Result.CANCELLED;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (from === to) {</span>
<span class="cstat-no" title="statement not covered" >          StateMachine.afterEvent(this, name, from, to, args);</span>
<span class="cstat-no" title="statement not covered" >          return StateMachine.Result.NOTRANSITION;</span>
        }
&nbsp;
        // prepare a transition method for use EITHER lower down, or by caller if they want an async transition (indicated by an ASYNC return value from leaveState)
<span class="cstat-no" title="statement not covered" >        var fsm = this;</span>
<span class="cstat-no" title="statement not covered" >        this.transition = <span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >          fsm.transition = null; </span>// this method should only ever be called once
<span class="cstat-no" title="statement not covered" >          fsm.current = to;</span>
<span class="cstat-no" title="statement not covered" >          StateMachine.enterState( fsm, name, from, to, args);</span>
<span class="cstat-no" title="statement not covered" >          StateMachine.changeState(fsm, name, from, to, args);</span>
<span class="cstat-no" title="statement not covered" >          StateMachine.afterEvent( fsm, name, from, to, args);</span>
<span class="cstat-no" title="statement not covered" >          return StateMachine.Result.SUCCEEDED;</span>
        };
<span class="cstat-no" title="statement not covered" >        this.transition.cancel = <span class="fstat-no" title="function not covered" >function() {</span> // provide a way for caller to cancel async transition if desired (issue #22)</span>
<span class="cstat-no" title="statement not covered" >          fsm.transition = null;</span>
<span class="cstat-no" title="statement not covered" >          StateMachine.afterEvent(fsm, name, from, to, args);</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        var leave = StateMachine.leaveState(this, name, from, to, args);</span>
<span class="cstat-no" title="statement not covered" >        if (false === leave) {</span>
<span class="cstat-no" title="statement not covered" >          this.transition = null;</span>
<span class="cstat-no" title="statement not covered" >          return StateMachine.Result.CANCELLED;</span>
        }
        else <span class="cstat-no" title="statement not covered" >if (StateMachine.ASYNC === leave) {</span>
<span class="cstat-no" title="statement not covered" >          return StateMachine.Result.PENDING;</span>
        }
        else {
<span class="cstat-no" title="statement not covered" >          if (this.transition) // need to check in case user manually called transition() but forgot to return StateMachine.ASYNC</span>
<span class="cstat-no" title="statement not covered" >            return this.transition();</span>
        }
&nbsp;
      };
    }
&nbsp;
  }; // StateMachine
&nbsp;
  //===========================================================================
&nbsp;
  //======
  // NODE
  //======
  <span class="missing-if-branch" title="else path not taken" >E</span>if (typeof exports !== 'undefined') {
    <span class="missing-if-branch" title="else path not taken" >E</span>if (typeof module !== 'undefined' &amp;&amp; module.exports) {
      exports = module.exports = StateMachine;
    }
    exports.StateMachine = StateMachine;
  }
  //============
  // AMD/REQUIRE
  //============
  else <span class="cstat-no" title="statement not covered" >if (typeof define === 'function' &amp;&amp; define.amd) {</span>
<span class="cstat-no" title="statement not covered" >    define(<span class="fstat-no" title="function not covered" >function(require) {</span> <span class="cstat-no" title="statement not covered" >return StateMachine; </span>});</span>
  }
  //========
  // BROWSER
  //========
  else <span class="cstat-no" title="statement not covered" >if (typeof window !== 'undefined') {</span>
<span class="cstat-no" title="statement not covered" >    window.StateMachine = StateMachine;</span>
  }
  //===========
  // WEB WORKER
  //===========
  else <span class="cstat-no" title="statement not covered" >if (typeof self !== 'undefined') {</span>
<span class="cstat-no" title="statement not covered" >    self.StateMachine = StateMachine;</span>
  }
&nbsp;
}());
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Fri Apr 21 2017 07:58:50 GMT+0000 (UTC)</div>
</div>
</body>
</html>
